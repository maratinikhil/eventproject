{% extends "base.html" %}
{% block title %}Login With Password{% endblock %}

{% block content %}

<style>
    /* Background animation styles */
    .gif-background {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        object-fit: cover;
        opacity: 0.15;
    }

    .gradient-background {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(-45deg, #1e40af, #3b82f6, #60a5fa, #93c5fd);
        background-size: 400% 400%;
        animation: gradient 20s ease infinite;
        z-index: -2;
    }

    @keyframes gradient {
        0% {
            background-position: 0% 50%;
        }

        50% {
            background-position: 100% 50%;
        }

        100% {
            background-position: 0% 50%;
        }
    }

    /* Security Animation */
    @keyframes lock-pulse {

        0%,
        100% {
            transform: translateY(0) scale(1);
        }

        50% {
            transform: translateY(-5px) scale(1.05);
        }
    }

    .lock-pulse {
        animation: lock-pulse 2s ease-in-out infinite;
    }

    @keyframes shield-rotate {
        from {
            transform: rotate(0deg);
        }

        to {
            transform: rotate(360deg);
        }
    }

    .shield-rotate {
        animation: shield-rotate 20s linear infinite;
    }

    @keyframes password-strength {
        0% {
            width: 0%;
            background: #ef4444;
        }

        50% {
            background: #f59e0b;
        }

        100% {
            width: var(--strength);
            background: #10b981;
        }
    }

    .strength-bar {
        animation: password-strength 1.5s ease-out forwards;
    }

    /* Input Focus Effects */
    @keyframes input-glow {

        0%,
        100% {
            box-shadow: 0 0 5px rgba(59, 130, 246, 0.3);
        }

        50% {
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.6);
        }
    }

    .input-glow {
        animation: input-glow 2s infinite;
    }

    /* Form Animation */
    @keyframes slide-in-right {
        from {
            opacity: 0;
            transform: translateX(-20px);
        }

        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    .slide-in-right {
        animation: slide-in-right 0.6s ease-out forwards;
    }

    /* Eye Icon Animation */
    @keyframes eye-blink {

        0%,
        100% {
            transform: scaleY(1);
        }

        50% {
            transform: scaleY(0.1);
        }
    }

    .eye-blink {
        animation: eye-blink 0.3s ease;
    }

    /* Button Hover Effect */
    @keyframes button-shimmer {
        0% {
            transform: translateX(-100%);
        }

        100% {
            transform: translateX(100%);
        }
    }

    .shimmer {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        animation: button-shimmer 2s infinite;
    }

    /* Responsive */
    @media (max-width: 640px) {
        .gif-background {
            opacity: 0.1;
        }
    }
</style>

<!-- Background Options - Choose One -->

<!-- OPTION 1: Blue Gradient Background (Recommended) -->
<div class="gradient-background"></div>

<!-- OPTION 2: Digital Lock Pattern GIF -->
<!--
<div class="gif-background-container relative">
    <img src="https://media.giphy.com/media/l0MYt5jPR6QX5pnqM/giphy.gif" alt="Digital pattern" class="gif-background">
    <div class="absolute inset-0 bg-black opacity-10"></div>
</div>
-->

<!-- OPTION 3: Animated Particles GIF -->
<!--
<div class="gif-background-container relative">
    <img src="https://media.giphy.com/media/3o7abldj0b3rxrZUxW/giphy.gif" alt="Particles animation" class="gif-background">
    <div class="absolute inset-0 bg-black opacity-10"></div>
</div>
-->

<!-- OPTION 4: Security/Shield Animation GIF -->
<!--
<div class="gif-background-container relative">
    <img src="https://media.giphy.com/media/jOZt5tdGYxzz0HvX2a/giphy.gif" alt="Security shield" class="gif-background">
    <div class="absolute inset-0 bg-black opacity-10"></div>
</div>
-->

<div class="min-h-screen flex items-center justify-center py-8 px-4 relative overflow-hidden">

    <!-- Animated Background Elements -->
    <div class="absolute top-10 left-10 w-32 h-32 bg-blue-400/20 rounded-full blur-3xl animate-pulse"></div>
    <div class="absolute bottom-10 right-10 w-40 h-40 bg-indigo-400/20 rounded-full blur-3xl animate-pulse"
        style="animation-delay: 1s;"></div>
    <div class="absolute top-1/3 right-1/4 w-24 h-24 bg-blue-300/20 rounded-full blur-3xl animate-pulse"
        style="animation-delay: 2s;"></div>

    <!-- Floating Security Icons -->
    <div class="absolute top-1/4 left-5 opacity-20">
        <svg class="w-16 h-16 text-blue-400 shield-rotate" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z" />
        </svg>
    </div>
    <div class="absolute bottom-1/3 right-5 opacity-20">
        <svg class="w-14 h-14 text-indigo-400 lock-pulse" fill="currentColor" viewBox="0 0 24 24">
            <path
                d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z" />
        </svg>
    </div>

    <!-- Main Content -->
    <div class="w-full max-w-md slide-in-right">
        <div
            class="bg-white/95 dark:bg-gray-800/95 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border border-white/20 dark:border-gray-700/30 relative overflow-hidden">

            <!-- Security Badge -->
            <div class="absolute top-4 right-4">
                <div class="relative">
                    <div
                        class="w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center">
                        <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                clip-rule="evenodd" />
                        </svg>
                    </div>
                    <div class="absolute -top-1 -right-1 w-4 h-4 bg-green-400 rounded-full border-2 border-white"></div>
                </div>
            </div>

            <!-- Header -->
            <div class="text-center mb-8">
                <div class="relative inline-block mb-4">
                    <div
                        class="w-20 h-20 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center mx-auto lock-pulse">
                        <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                        </svg>
                    </div>
                    <!-- Animated Rings -->
                    <div class="absolute inset-0 border-2 border-blue-300 rounded-full animate-ping opacity-20"></div>
                    <div class="absolute inset-0 border-2 border-blue-400 rounded-full animate-ping opacity-10"
                        style="animation-delay: 0.5s;"></div>
                </div>

                <h2
                    class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent mb-2">
                    Secure Login
                </h2>
                <p class="text-gray-600 dark:text-gray-300 text-sm">
                    Enter your password to continue securely
                </p>

                <!-- Display User Info -->
                {% if request.session.login_email or request.session.login_mobile %}
                <div class="mt-3 flex items-center justify-center space-x-2">
                    <div class="w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center">
                        <svg class="w-4 h-4 text-blue-600 dark:text-blue-400" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
                                clip-rule="evenodd" />
                        </svg>
                    </div>
                    <span class="text-sm font-medium text-gray-700 dark:text-gray-300" id="user-display">
                        {{ request.session.login_email|default:request.session.login_mobile }}
                    </span>
                </div>
                {% endif %}
            </div>

            <!-- Messages -->
            {% if messages %}
            <div class="mb-6 space-y-2">
                {% for message in messages %}
                <div
                    class="p-4 rounded-xl {% if message.tags == 'error' %}bg-red-100 text-red-800 border border-red-200{% else %}bg-green-100 text-green-800 border border-green-200{% endif %} transform transition-all duration-300 hover:scale-[1.02]">
                    <div class="flex items-center">
                        <svg class="w-5 h-5 mr-3 flex-shrink-0 {% if message.tags == 'error' %}text-red-600{% else %}text-green-600{% endif %}"
                            fill="currentColor" viewBox="0 0 20 20">
                            {% if message.tags == 'error' %}
                            <path fill-rule="evenodd"
                                d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
                                clip-rule="evenodd" />
                            {% else %}
                            <path fill-rule="evenodd"
                                d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                clip-rule="evenodd" />
                            {% endif %}
                        </svg>
                        {{ message }}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}

            <!-- Password Form -->
            <form method="post" class="space-y-6" id="password-form">
                {% csrf_token %}

                <!-- Password Input -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                        <span class="flex items-center">
                            <svg class="w-4 h-4 mr-2 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z"
                                    clip-rule="evenodd" />
                            </svg>
                            Password
                        </span>
                    </label>

                    <div class="relative group">
                        <input type="password" name="password" id="password-input" placeholder="Enter your password"
                            class="w-full border-2 border-gray-300 dark:border-gray-600 rounded-xl p-4 pl-12 pr-12 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700/50 dark:text-white transition-all duration-300 group-hover:border-blue-400"
                            required autocomplete="current-password">

                        <!-- Lock Icon -->
                        <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                            <svg class="h-5 w-5 text-gray-400 group-hover:text-blue-500 transition-colors" fill="none"
                                stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                            </svg>
                        </div>

                        <!-- Eye Toggle Button -->
                        <button type="button" id="toggle-password"
                            class="absolute inset-y-0 right-0 pr-4 flex items-center text-gray-400 hover:text-blue-500 transition-colors">
                            <svg id="eye-icon" class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                            </svg>
                        </button>
                    </div>

                    <!-- Password Strength Indicator -->
                    <div class="mt-3 space-y-2">
                        <div class="flex justify-between text-xs text-gray-500">
                            <span>Password strength</span>
                            <span id="strength-text" class="font-medium">Enter password</span>
                        </div>
                        <div class="h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                            <div id="strength-bar" class="h-full rounded-full transition-all duration-300"
                                style="width: 0%; background: #ef4444;"></div>
                        </div>
                    </div>

                    <!-- Password Requirements -->
                    <div class="mt-3 grid grid-cols-2 gap-2 text-xs">
                        <div class="flex items-center" id="req-length">
                            <div class="w-2 h-2 rounded-full bg-gray-300 mr-2"></div>
                            <span class="text-gray-500">8+ characters</span>
                        </div>
                        <div class="flex items-center" id="req-uppercase">
                            <div class="w-2 h-2 rounded-full bg-gray-300 mr-2"></div>
                            <span class="text-gray-500">Uppercase</span>
                        </div>
                        <div class="flex items-center" id="req-lowercase">
                            <div class="w-2 h-2 rounded-full bg-gray-300 mr-2"></div>
                            <span class="text-gray-500">Lowercase</span>
                        </div>
                        <div class="flex items-center" id="req-number">
                            <div class="w-2 h-2 rounded-full bg-gray-300 mr-2"></div>
                            <span class="text-gray-500">Number</span>
                        </div>
                    </div>
                </div>

                <!-- Remember Me & Forgot Password -->
                <div class="flex items-center justify-between">
                    <label class="flex items-center cursor-pointer group">
                        <div class="relative">
                            <input type="checkbox" name="remember" class="sr-only peer">
                            <div
                                class="w-5 h-5 bg-gray-200 dark:bg-gray-700 rounded border border-gray-300 dark:border-gray-600 peer-checked:bg-blue-500 peer-checked:border-blue-500 transition-colors duration-200">
                            </div>
                            <div
                                class="absolute inset-0 flex items-center justify-center opacity-0 peer-checked:opacity-100 transition-opacity duration-200">
                                <svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3"
                                        d="M5 13l4 4L19 7" />
                                </svg>
                            </div>
                        </div>
                        <span
                            class="ml-2 text-sm text-gray-700 dark:text-gray-300 group-hover:text-blue-600 transition-colors">
                            Remember me
                        </span>
                    </label>

                    <a href="{% url 'forgot_password' %}" class="text-sm text-blue-600 hover:text-blue-500 transition-colors">
                        Forgot Password?
                    </a>
                </div>

                <!-- Login Button -->
                <button type="submit" id="login-btn"
                    class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white py-4 rounded-xl font-semibold transition-all duration-300 transform hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-xl group relative overflow-hidden">
                    <span class="relative z-10 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2 group-hover:rotate-12 transition-transform" fill="none"
                            stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        Sign In
                    </span>
                    <div
                        class="shimmer absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                    </div>
                    <div
                        class="absolute inset-0 bg-gradient-to-r from-blue-700 to-indigo-700 transform translate-y-full group-hover:translate-y-0 transition-transform duration-300">
                    </div>
                </button>
            </form>

            <!-- Alternative Login Methods -->
            <div class="mt-8 pt-6 border-t border-gray-200/50 dark:border-gray-700/50">
                <p class="text-center text-gray-600 dark:text-gray-300 text-sm mb-4">
                    Or continue with
                </p>

                <div class="flex justify-center space-x-4">
                    <!-- OTP Login Button -->
                    <a href="{% url 'login' %}"
                        class="flex-1 flex items-center justify-center p-3 border border-gray-300 dark:border-gray-600 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-300 group">
                        <svg class="w-5 h-5 text-gray-500 group-hover:text-blue-500 transition-colors mr-2"
                            fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M2 5a2 2 0 012-2h12a2 2 0 012 2v2a2 2 0 01-2 2H4a2 2 0 01-2-2V5zm14 1a1 1 0 11-2 0 1 1 0 012 0zM2 13a2 2 0 012-2h12a2 2 0 012 2v2a2 2 0 01-2 2H4a2 2 0 01-2-2v-2zm14 1a1 1 0 11-2 0 1 1 0 012 0z"
                                clip-rule="evenodd" />
                        </svg>
                        <span class="text-sm font-medium text-gray-700 dark:text-gray-300 group-hover:text-blue-600">
                            OTP Login
                        </span>
                    </a>

                    <!-- Social Login (Example) -->
                    <button type="button"
                        class="flex-1 flex items-center justify-center p-3 border border-gray-300 dark:border-gray-600 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-300 group">
                        <svg class="w-5 h-5 text-gray-500 group-hover:text-blue-500 transition-colors mr-2"
                            fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
                                clip-rule="evenodd" />
                        </svg>
                        <span class="text-sm font-medium text-gray-700 dark:text-gray-300 group-hover:text-blue-600">
                            Social
                        </span>
                    </button>
                </div>
            </div>

            <!-- Signup Link -->
            <div class="text-center mt-6">
                <p class="text-gray-600 dark:text-gray-300 text-sm">
                    Don't have an account?
                    <a href="{% url 'signup' %}"
                        class="text-blue-600 hover:text-blue-500 font-medium transition-all duration-300 hover:underline inline-flex items-center group">
                        Sign up now
                        <svg class="w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform" fill="none"
                            stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M17 8l4 4m0 0l-4 4m4-4H3" />
                        </svg>
                    </a>
                </p>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const passwordInput = document.getElementById('password-input');
        const toggleButton = document.getElementById('toggle-password');
        const eyeIcon = document.getElementById('eye-icon');
        const strengthBar = document.getElementById('strength-bar');
        const strengthText = document.getElementById('strength-text');
        const loginBtn = document.getElementById('login-btn');
        const passwordForm = document.getElementById('password-form');

        // Password visibility toggle
        let isPasswordVisible = false;

        toggleButton.addEventListener('click', function () {
            isPasswordVisible = !isPasswordVisible;
            passwordInput.type = isPasswordVisible ? 'text' : 'password';

            // Animate eye icon
            eyeIcon.classList.add('eye-blink');
            setTimeout(() => {
                eyeIcon.classList.remove('eye-blink');
            }, 300);

            // Update eye icon
            if (isPasswordVisible) {
                eyeIcon.innerHTML = `
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L6.59 6.59m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21" />
                `;
            } else {
                eyeIcon.innerHTML = `
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                `;
            }
        });

        // Password strength checker
        function checkPasswordStrength(password) {
            let score = 0;
            const requirements = {
                length: false,
                uppercase: false,
                lowercase: false,
                number: false,
                special: false
            };

            // Length check
            if (password.length >= 8) {
                score += 25;
                requirements.length = true;
            }

            // Uppercase check
            if (/[A-Z]/.test(password)) {
                score += 25;
                requirements.uppercase = true;
            }

            // Lowercase check
            if (/[a-z]/.test(password)) {
                score += 25;
                requirements.lowercase = true;
            }

            // Number check
            if (/[0-9]/.test(password)) {
                score += 15;
                requirements.number = true;
            }

            // Special character check
            if (/[^A-Za-z0-9]/.test(password)) {
                score += 10;
                requirements.special = true;
            }

            // Cap score at 100
            score = Math.min(score, 100);

            return { score, requirements };
        }

        function updatePasswordStrength(password) {
            const { score, requirements } = checkPasswordStrength(password);

            // Update strength bar
            strengthBar.style.width = `${score}%`;
            strengthBar.style.setProperty('--strength', `${score}%`);

            // Update strength text and color
            let color, text;
            if (score === 0) {
                color = '#ef4444';
                text = 'Enter password';
            } else if (score < 40) {
                color = '#ef4444';
                text = 'Weak';
            } else if (score < 70) {
                color = '#f59e0b';
                text = 'Fair';
            } else if (score < 90) {
                color = '#10b981';
                text = 'Good';
            } else {
                color = '#059669';
                text = 'Strong';
            }

            strengthBar.style.background = color;
            strengthText.textContent = text;
            strengthText.style.color = color;

            // Update requirement indicators
            document.getElementById('req-length').style.color = requirements.length ? '#10b981' : '';
            document.getElementById('req-length').firstElementChild.style.background = requirements.length ? '#10b981' : '';

            document.getElementById('req-uppercase').style.color = requirements.uppercase ? '#10b981' : '';
            document.getElementById('req-uppercase').firstElementChild.style.background = requirements.uppercase ? '#10b981' : '';

            document.getElementById('req-lowercase').style.color = requirements.lowercase ? '#10b981' : '';
            document.getElementById('req-lowercase').firstElementChild.style.background = requirements.lowercase ? '#10b981' : '';

            document.getElementById('req-number').style.color = requirements.number ? '#10b981' : '';
            document.getElementById('req-number').firstElementChild.style.background = requirements.number ? '#10b981' : '';
        }

        // Real-time password strength feedback
        passwordInput.addEventListener('input', function () {
            updatePasswordStrength(this.value);
        });

        // Form submission with animation
        passwordForm.addEventListener('submit', function (e) {
            const password = passwordInput.value;

            if (!password) {
                e.preventDefault();
                passwordInput.classList.add('input-glow');
                setTimeout(() => {
                    passwordInput.classList.remove('input-glow');
                }, 2000);
                return false;
            }

            // Add loading state to button
            loginBtn.disabled = true;
            loginBtn.innerHTML = `
                <span class="flex items-center justify-center">
                    <svg class="w-5 h-5 mr-2 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                    </svg>
                    Verifying...
                </span>
            `;
        });

        // Mask email/mobile for display
        const userDisplay = document.getElementById('user-display');
        if (userDisplay) {
            const userInfo = userDisplay.textContent.trim();
            if (userInfo.includes('@')) {
                // Email masking
                const [username, domain] = userInfo.split('@');
                const masked = username.charAt(0) + '•••••' + username.slice(-1) + '@' + domain;
                userDisplay.textContent = masked;
            } else if (userInfo.match(/^\d+$/)) {
                // Phone number masking
                const masked = '••••••' + userInfo.slice(-4);
                userDisplay.textContent = masked;
            }
        }

        // Focus effect for password input
        passwordInput.addEventListener('focus', function () {
            this.parentElement.classList.add('ring-2', 'ring-blue-200', 'rounded-xl');
        });

        passwordInput.addEventListener('blur', function () {
            this.parentElement.classList.remove('ring-2', 'ring-blue-200', 'rounded-xl');
        });

        // Initialize with empty password strength
        updatePasswordStrength('');
    });
</script>

{% endblock %}